<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Custom CC (WIP) | Komodo Documentation</title>
    <meta name="description" content="Documentation for developers building on Komodo">
    <link rel="icon" href="komodo-logo-icon-black.png">
    <link rel="preload" href="/assets/css/0.styles.edc0cc79.css" as="style"><link rel="preload" href="/assets/js/app.38351d9b.js" as="script"><link rel="preload" href="/assets/js/2.c8a0d3c8.js" as="script"><link rel="preload" href="/assets/js/23.48a6b7ab.js" as="script"><link rel="prefetch" href="/assets/js/10.09ca6c5e.js"><link rel="prefetch" href="/assets/js/100.ae2a8793.js"><link rel="prefetch" href="/assets/js/101.7dcd3f07.js"><link rel="prefetch" href="/assets/js/102.b60e2e33.js"><link rel="prefetch" href="/assets/js/103.c1b77490.js"><link rel="prefetch" href="/assets/js/104.de33587c.js"><link rel="prefetch" href="/assets/js/105.5abeb2bd.js"><link rel="prefetch" href="/assets/js/106.4c4dbae5.js"><link rel="prefetch" href="/assets/js/107.ec4c709e.js"><link rel="prefetch" href="/assets/js/108.94e187ff.js"><link rel="prefetch" href="/assets/js/109.341ac117.js"><link rel="prefetch" href="/assets/js/11.e5ecf252.js"><link rel="prefetch" href="/assets/js/110.5f7abce1.js"><link rel="prefetch" href="/assets/js/111.6989ac0c.js"><link rel="prefetch" href="/assets/js/112.487d9d33.js"><link rel="prefetch" href="/assets/js/113.08302549.js"><link rel="prefetch" href="/assets/js/114.3fc2f57d.js"><link rel="prefetch" href="/assets/js/115.d04ed361.js"><link rel="prefetch" href="/assets/js/116.25daa067.js"><link rel="prefetch" href="/assets/js/117.3859f452.js"><link rel="prefetch" href="/assets/js/118.11404bc3.js"><link rel="prefetch" href="/assets/js/119.5473dead.js"><link rel="prefetch" href="/assets/js/12.e5aa6c57.js"><link rel="prefetch" href="/assets/js/120.df23fc34.js"><link rel="prefetch" href="/assets/js/121.bd41e894.js"><link rel="prefetch" href="/assets/js/122.fe04273c.js"><link rel="prefetch" href="/assets/js/123.4bccb386.js"><link rel="prefetch" href="/assets/js/124.23fa83b6.js"><link rel="prefetch" href="/assets/js/125.93316e17.js"><link rel="prefetch" href="/assets/js/126.c619fa5e.js"><link rel="prefetch" href="/assets/js/127.3a1c0bf6.js"><link rel="prefetch" href="/assets/js/128.e01fdc79.js"><link rel="prefetch" href="/assets/js/129.fc16d432.js"><link rel="prefetch" href="/assets/js/13.6d6eac57.js"><link rel="prefetch" href="/assets/js/130.2a334e71.js"><link rel="prefetch" href="/assets/js/131.276dbc45.js"><link rel="prefetch" href="/assets/js/132.85d8244c.js"><link rel="prefetch" href="/assets/js/133.2ae3624e.js"><link rel="prefetch" href="/assets/js/134.eb9b218c.js"><link rel="prefetch" href="/assets/js/135.9caf9981.js"><link rel="prefetch" href="/assets/js/136.c44f8bd7.js"><link rel="prefetch" href="/assets/js/137.ebdcf72c.js"><link rel="prefetch" href="/assets/js/138.e1e1030d.js"><link rel="prefetch" href="/assets/js/139.32195aa5.js"><link rel="prefetch" href="/assets/js/14.b60491a7.js"><link rel="prefetch" href="/assets/js/140.0bb8c57a.js"><link rel="prefetch" href="/assets/js/141.52525ccf.js"><link rel="prefetch" href="/assets/js/142.62498bf0.js"><link rel="prefetch" href="/assets/js/143.97359d27.js"><link rel="prefetch" href="/assets/js/144.8221c1e6.js"><link rel="prefetch" href="/assets/js/145.ea5af076.js"><link rel="prefetch" href="/assets/js/146.41f9dc80.js"><link rel="prefetch" href="/assets/js/147.06deb599.js"><link rel="prefetch" href="/assets/js/148.b0f6cb6b.js"><link rel="prefetch" href="/assets/js/149.f9a2fd0a.js"><link rel="prefetch" href="/assets/js/15.babc44a9.js"><link rel="prefetch" href="/assets/js/150.54b2c270.js"><link rel="prefetch" href="/assets/js/151.6efe884b.js"><link rel="prefetch" href="/assets/js/152.27e56738.js"><link rel="prefetch" href="/assets/js/153.6d598cac.js"><link rel="prefetch" href="/assets/js/154.e1d7aafc.js"><link rel="prefetch" href="/assets/js/155.9d477edd.js"><link rel="prefetch" href="/assets/js/156.7533f269.js"><link rel="prefetch" href="/assets/js/157.140c5793.js"><link rel="prefetch" href="/assets/js/16.1fcc982c.js"><link rel="prefetch" href="/assets/js/17.d2f5520e.js"><link rel="prefetch" href="/assets/js/18.86adf91b.js"><link rel="prefetch" href="/assets/js/19.23238cf5.js"><link rel="prefetch" href="/assets/js/20.cef30440.js"><link rel="prefetch" href="/assets/js/21.2133cf30.js"><link rel="prefetch" href="/assets/js/22.a034125f.js"><link rel="prefetch" href="/assets/js/24.9b498c1b.js"><link rel="prefetch" href="/assets/js/25.adabf1f4.js"><link rel="prefetch" href="/assets/js/26.2f1d1daa.js"><link rel="prefetch" href="/assets/js/27.349cac7d.js"><link rel="prefetch" href="/assets/js/28.81f9ac87.js"><link rel="prefetch" href="/assets/js/29.1101dc26.js"><link rel="prefetch" href="/assets/js/3.2fd6f943.js"><link rel="prefetch" href="/assets/js/30.3a58af0f.js"><link rel="prefetch" href="/assets/js/31.21bb1c92.js"><link rel="prefetch" href="/assets/js/32.6ae225f7.js"><link rel="prefetch" href="/assets/js/33.7cf60c95.js"><link rel="prefetch" href="/assets/js/34.ee16d5a1.js"><link rel="prefetch" href="/assets/js/35.0ccad417.js"><link rel="prefetch" href="/assets/js/36.d068b2ef.js"><link rel="prefetch" href="/assets/js/37.466be39f.js"><link rel="prefetch" href="/assets/js/38.0d2589bb.js"><link rel="prefetch" href="/assets/js/39.a5d6b192.js"><link rel="prefetch" href="/assets/js/4.3b529539.js"><link rel="prefetch" href="/assets/js/40.ae57ea7b.js"><link rel="prefetch" href="/assets/js/41.3ce7bf23.js"><link rel="prefetch" href="/assets/js/42.078f5aea.js"><link rel="prefetch" href="/assets/js/43.38b25014.js"><link rel="prefetch" href="/assets/js/44.97e0c1a7.js"><link rel="prefetch" href="/assets/js/45.30048475.js"><link rel="prefetch" href="/assets/js/46.c1f075fd.js"><link rel="prefetch" href="/assets/js/47.d0ed0999.js"><link rel="prefetch" href="/assets/js/48.c0be7d4c.js"><link rel="prefetch" href="/assets/js/49.f5a10a09.js"><link rel="prefetch" href="/assets/js/5.5f30dec9.js"><link rel="prefetch" href="/assets/js/50.b5dfd223.js"><link rel="prefetch" href="/assets/js/51.023290f6.js"><link rel="prefetch" href="/assets/js/52.6cd7a3c9.js"><link rel="prefetch" href="/assets/js/53.dbe1b02a.js"><link rel="prefetch" href="/assets/js/54.14184f80.js"><link rel="prefetch" href="/assets/js/55.4c8526a5.js"><link rel="prefetch" href="/assets/js/56.2979048a.js"><link rel="prefetch" href="/assets/js/57.ea01f1eb.js"><link rel="prefetch" href="/assets/js/58.3bb62bf0.js"><link rel="prefetch" href="/assets/js/59.f1154483.js"><link rel="prefetch" href="/assets/js/6.8dd10eb6.js"><link rel="prefetch" href="/assets/js/60.23bb7cc0.js"><link rel="prefetch" href="/assets/js/61.d4c9d28e.js"><link rel="prefetch" href="/assets/js/62.c8a46bd4.js"><link rel="prefetch" href="/assets/js/63.2f958ca8.js"><link rel="prefetch" href="/assets/js/64.14a38dda.js"><link rel="prefetch" href="/assets/js/65.e484300c.js"><link rel="prefetch" href="/assets/js/66.9a3d09ab.js"><link rel="prefetch" href="/assets/js/67.58c8b927.js"><link rel="prefetch" href="/assets/js/68.b91c304c.js"><link rel="prefetch" href="/assets/js/69.078a6bb3.js"><link rel="prefetch" href="/assets/js/7.65b77aed.js"><link rel="prefetch" href="/assets/js/70.66087a96.js"><link rel="prefetch" href="/assets/js/71.567d55b1.js"><link rel="prefetch" href="/assets/js/72.827e5877.js"><link rel="prefetch" href="/assets/js/73.d62f4b8b.js"><link rel="prefetch" href="/assets/js/74.d59c5131.js"><link rel="prefetch" href="/assets/js/75.d25128de.js"><link rel="prefetch" href="/assets/js/76.9043f4fb.js"><link rel="prefetch" href="/assets/js/77.188eb6ff.js"><link rel="prefetch" href="/assets/js/78.a05f49c9.js"><link rel="prefetch" href="/assets/js/79.510a13d0.js"><link rel="prefetch" href="/assets/js/8.8aa8e600.js"><link rel="prefetch" href="/assets/js/80.e634a7fa.js"><link rel="prefetch" href="/assets/js/81.20b6693b.js"><link rel="prefetch" href="/assets/js/82.e3c128d2.js"><link rel="prefetch" href="/assets/js/83.a5fec384.js"><link rel="prefetch" href="/assets/js/84.7a816aa5.js"><link rel="prefetch" href="/assets/js/85.b1c24cb9.js"><link rel="prefetch" href="/assets/js/86.3c467fcd.js"><link rel="prefetch" href="/assets/js/87.a42153c7.js"><link rel="prefetch" href="/assets/js/88.acc38634.js"><link rel="prefetch" href="/assets/js/89.cbea9034.js"><link rel="prefetch" href="/assets/js/9.f2a5062a.js"><link rel="prefetch" href="/assets/js/90.dace1e32.js"><link rel="prefetch" href="/assets/js/91.d02982ae.js"><link rel="prefetch" href="/assets/js/92.9f310312.js"><link rel="prefetch" href="/assets/js/93.fe7f769c.js"><link rel="prefetch" href="/assets/js/94.ca42ed7c.js"><link rel="prefetch" href="/assets/js/95.06f96925.js"><link rel="prefetch" href="/assets/js/96.92e8a0e3.js"><link rel="prefetch" href="/assets/js/97.18a473b7.js"><link rel="prefetch" href="/assets/js/98.16d345eb.js"><link rel="prefetch" href="/assets/js/99.3a6d264b.js">
    <link rel="stylesheet" href="/assets/css/0.styles.edc0cc79.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><img src="/komodo-logo-icon-black.png" alt="Komodo Documentation" class="logo"> <span class="site-name can-hide">Komodo Documentation</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/basic-docs/start-here/outline-for-new-developers.html" class="nav-link">Start Here</a></div><div class="nav-item"><a href="/whitepaper/introduction.html" class="nav-link">Whitepaper</a></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title">Guides</span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/komodo/installation.html" class="nav-link">Komodo</a></li><li class="dropdown-item"><!----> <a href="/assetchains/beginner-vps-linux.html" class="nav-link">Asset Chains</a></li><li class="dropdown-item"><!----> <a href="/notary/setup-Komodo-Notary-Node.html" class="nav-link">Notary Nodes</a></li><li class="dropdown-item"><!----> <a href="/mmV1/introduction.html" class="nav-link">Marketmaker V1</a></li></ul></div></div><div class="nav-item"><a href="/cc-jl/introduction.html" class="nav-link">CC Book</a></div><div class="nav-item"><a href="/gui/agama/introduction.html" class="nav-link">Agama</a></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title">Resources</span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/resources/list-all-KomodoPlatform-repos-links.html" class="nav-link">Komodo Platform</a></li><li class="dropdown-item"><!----> <a href="/resources/third-party-repos-resources.html" class="nav-link">Third Party</a></li></ul></div></div><div class="nav-item"><a href="https://komodoplatform.com" target="_blank" rel="noopener noreferrer" class="nav-link external">
  KomodoPlatform.com
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div> <a href="https://github.com/komodoplatform/Documentation" target="_blank" rel="noopener noreferrer" class="repo-link">
    Github
    <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/basic-docs/start-here/outline-for-new-developers.html" class="nav-link">Start Here</a></div><div class="nav-item"><a href="/whitepaper/introduction.html" class="nav-link">Whitepaper</a></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title">Guides</span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/komodo/installation.html" class="nav-link">Komodo</a></li><li class="dropdown-item"><!----> <a href="/assetchains/beginner-vps-linux.html" class="nav-link">Asset Chains</a></li><li class="dropdown-item"><!----> <a href="/notary/setup-Komodo-Notary-Node.html" class="nav-link">Notary Nodes</a></li><li class="dropdown-item"><!----> <a href="/mmV1/introduction.html" class="nav-link">Marketmaker V1</a></li></ul></div></div><div class="nav-item"><a href="/cc-jl/introduction.html" class="nav-link">CC Book</a></div><div class="nav-item"><a href="/gui/agama/introduction.html" class="nav-link">Agama</a></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title">Resources</span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/resources/list-all-KomodoPlatform-repos-links.html" class="nav-link">Komodo Platform</a></li><li class="dropdown-item"><!----> <a href="/resources/third-party-repos-resources.html" class="nav-link">Third Party</a></li></ul></div></div><div class="nav-item"><a href="https://komodoplatform.com" target="_blank" rel="noopener noreferrer" class="nav-link external">
  KomodoPlatform.com
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div> <a href="https://github.com/komodoplatform/Documentation" target="_blank" rel="noopener noreferrer" class="repo-link">
    Github
    <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></nav>  <ul class="sidebar-links"><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading open"><span>Start Here</span> <span class="arrow down"></span></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/basic-docs/start-here/outline-for-new-developers.html" class="sidebar-link">Outline for New Developers</a></li><li><a href="/basic-docs/start-here/custom-consensus-overview.html" class="sidebar-link">Overview of Custom Consensus</a></li></ul></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Installation and Setup</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Custom Consensus</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Komodo API</span> <span class="arrow right"></span></p> <!----></section></li></ul> </aside> <main class="page"> <div class="content default"><h1 id="custom-cc-wip"><a href="#custom-cc-wip" aria-hidden="true" class="header-anchor">#</a> Custom CC (WIP)</h1> <p>This document is a work in progress (WIP)</p> <p>We are fortunate to have been gifted the ability to launch provable ecosystems to build upon.  This tutorial begins with a quick foundation of core concepts then moving into how to make dApps with layer-1, on-chain consensus. The smart-UTXO system of Komodo's Crypto-Conditions.  Consensus &amp; Smart Contract customizations.</p> <h2 id="blockchain-core-concepts"><a href="#blockchain-core-concepts" aria-hidden="true" class="header-anchor">#</a> Blockchain Core Concepts</h2> <ul><li>Public key cryptography is used when a private and public key pair are used for proving something.</li> <li>Private Keys are stored in a wallet, not on the blockchain.</li> <li>Private keys sign transactions.</li> <li>Signatures on transaction are proven by the network using the corresponding public key to spend the claimed ownership of funds.</li> <li>Transactions fill blocks, like an item on a shopping list fills a piece of paper.</li> <li>Blocks are arranged in sequential order, forming a chain.</li> <li>Each block contains agreed transactional information. The proof of the transactional detail and it's arrangement in the block is called consensus. Consensus is achieved by each participant relying on their own computation.</li> <li>Coins &amp; Tokens are used in transaction details to transfer value.</li> <li>Nodes is the jargon term for computers that do the computations to maintain the network.</li> <li>Maintaining the network is done by validating.  OP_CODES are the instructions of the network that need validating.</li> <li>Some nodes are heavily computational (miners), some are quiet and store a valuable private key within the wallet.</li> <li>There's additional software to make this blockchain useful (for transfering value) &amp; easier to use. Like the internet became useful for transfering information, blockchain technology enables dApps to create new ways of collaborating.  Blockchain: Mobile Wallets, DEX, Explorers vs WWW: webserver, database, email &amp; streaming protocols)</li></ul> <h2 id="goal-of-our-custom-consensus-module"><a href="#goal-of-our-custom-consensus-module" aria-hidden="true" class="header-anchor">#</a> Goal of our custom consensus module</h2> <p>This <code>customcc</code> loadable library example is simply something that requires to send 1 coin.  It can't get much simpler.</p> <h2 id="use-jl777-branch"><a href="#use-jl777-branch" aria-hidden="true" class="header-anchor">#</a> Use jl777 branch</h2> <div class="language-bash extra-class"><pre class="language-bash"><code><span class="token function">git</span> clone https://github.com/jl777/komodo.git
<span class="token function">git</span> checkout jl777
<span class="token function">cd</span> komodo/src/cc
code <span class="token keyword">.</span>
</code></pre></div><p>Open the 3 files</p> <ul><li>customcc.h <a href="https://github.com/jl777/komodo/blob/jl777/src/cc/customcc.h" target="_blank" rel="noopener noreferrer">src<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li> <li>customcc.cpp <a href="https://github.com/jl777/komodo/blob/jl777/src/cc/customcc.cpp" target="_blank" rel="noopener noreferrer">src<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li> <li>makecustom <a href="https://github.com/jl777/komodo/blob/jl777/src/cc/makecustom" target="_blank" rel="noopener noreferrer">src<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li></ul> <p>These are the three files we'll work on for learning how to apply custom consensus to a blockchain.  For most 1st &amp; 2nd generation blockchain projects, changing consensus is a bold undertaking.  Komodo has turned it into a loadable module removing the risk of severe bugs - no other project offers this to a custom blockchain.</p> <p>These 3 files are not boilercode.  It may look like boilercode but it's the gateway to much more powerful stuff.   This is the pandoras box of dApps.  Get ready to understand how to develop on a secure multi-chain distrbuted transactional system.</p> <h2 id="customcc-h-header-file-definitions-of-functions-and-variables"><a href="#customcc-h-header-file-definitions-of-functions-and-variables" aria-hidden="true" class="header-anchor">#</a> customcc.h header file - definitions of functions and variables</h2> <p>From the top, the comments provide a nice summary of what our custom cclib will do.</p> <h3 id="name-of-our-custom-cclib"><a href="#name-of-our-custom-cclib" aria-hidden="true" class="header-anchor">#</a> Name of our custom cclib</h3> <p>One is referenced externally (<code>MYCCLIBNAME</code>) at komodo start.  The other internally (<code>MYCCNAME</code>) when programming for function name prefixes.</p> <div class="language-cpp extra-class"><pre class="language-cpp"><code>std<span class="token operator">::</span>string MYCCLIBNAME <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">char</span> <span class="token operator">*</span><span class="token punctuation">)</span><span class="token string">&quot;customcc&quot;</span><span class="token punctuation">;</span>
<span class="token macro property">#<span class="token directive keyword">define</span> MYCCNAME &quot;custom&quot;</span>
</code></pre></div><p><code>MYCCLIBNAME</code> This is the name of the loadable library module being created.  Here it is &quot;customcc&quot;.  This is what is used on the command line to load your custom consensus when <a href="/basic-docs/installations/creating-asset-chains.html">starting your custom blockchain</a> on a komodo server.</p> <div class="language-bash extra-class"><pre class="language-bash"><code>komodod -ac_name<span class="token operator">=</span>CUSTOM -ac_cc<span class="token operator">=</span>1 -ac_cclib<span class="token operator">=</span>customcc <span class="token punctuation">..</span>.
</code></pre></div><p>The <code>MYCCNAME</code> is the prefix for RPC calls and standard consensus functions (e.g. <code>validate</code>).
The naming convention used for building a custom consensus library follows:</p> <ul><li>MYCCNAME_FUNCTIONNAME</li></ul> <p>For example <code>custom_validate</code>.</p> <h3 id="declaration-of-constants"><a href="#declaration-of-constants" aria-hidden="true" class="header-anchor">#</a> Declaration of constants</h3> <div class="language-cpp extra-class"><pre class="language-cpp"><code><span class="token macro property">#<span class="token directive keyword">define</span> EVAL_CUSTOM (EVAL_FAUCET2+1)</span>
<span class="token macro property">#<span class="token directive keyword">define</span> CUSTOM_TXFEE 10000</span>
</code></pre></div><p>The <code>EVAL_FAUCET2</code> is a constant (footnote: 1a &amp; 1b) (<code>0x10</code> or decimal 16).   These <code>EVAL_...</code> constants are identifiers.  They are used to route the validation code.  The low-level bitcoin script in Komodo has a new op_code called <code>OP_CHECKCRYPTOCONDITION</code>.   When any node on the network needs to validate this <code>OP_CHECKCRYPTOCONDITION</code> op_code, it looks up which <code>EVAL_...</code> code it is.</p> <p>Custom consensus starts at <code>EVAL_FAUCET2</code> and add <code>+1</code> to it for your customcc library.  Therefore, <code>EVAL_CUSTOM</code> is <code>0x11</code> = decimal 17.</p> <p>The <code>CUSTOM_TXFEE</code> is the default transaction fee for this type of transaction.  The default txfee for this <code>EVAL_...</code> code consensus is <code>10000</code> assetoshis (0.0001).</p> <h3 id="declarations-of-the-rpc-calls"><a href="#declarations-of-the-rpc-calls" aria-hidden="true" class="header-anchor">#</a> Declarations of the RPC calls</h3> <p>This is the way 3rd party developers (e.g. front-end developers) and command-line users will interact with your custom crypto condition.  For example commands like <code>komodo-cli -ac_name=CUSTOM custom_func0</code> and <code>komodo-cli -ac_name=CUSTOM custom_func1</code>.</p> <div class="language-cpp extra-class"><pre class="language-cpp"><code><span class="token punctuation">{</span> <span class="token punctuation">(</span><span class="token keyword">char</span> <span class="token operator">*</span><span class="token punctuation">)</span>MYCCNAME<span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token keyword">char</span> <span class="token operator">*</span><span class="token punctuation">)</span><span class="token string">&quot;func0&quot;</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token keyword">char</span> <span class="token operator">*</span><span class="token punctuation">)</span><span class="token string">&quot;&lt;parameter help&gt;&quot;</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token string">'0'</span><span class="token punctuation">,</span> EVAL_CUSTOM <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">{</span> <span class="token punctuation">(</span><span class="token keyword">char</span> <span class="token operator">*</span><span class="token punctuation">)</span>MYCCNAME<span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token keyword">char</span> <span class="token operator">*</span><span class="token punctuation">)</span><span class="token string">&quot;func1&quot;</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token keyword">char</span> <span class="token operator">*</span><span class="token punctuation">)</span><span class="token string">&quot;&lt;no args&gt;&quot;</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token string">'1'</span><span class="token punctuation">,</span> EVAL_CUSTOM <span class="token punctuation">}</span><span class="token punctuation">,</span>
</code></pre></div><p>The declarations for the functions in customcc.cpp - func0 and func1</p> <ul><li><code>MYCCNAME</code> is declared previously as &quot;custom&quot;</li> <li><code>func0</code> is the name of the first RPC call</li> <li>The <code>&lt;parameter help&gt;</code> can be replaced with your functions help text.</li> <li>The <code>1,1,'0', EVAL_CUSTOM</code> means: 1 mandatory parameter, maximum of 1 parameter, 0 is the function id for custom consensus <code>EVAL_CUSTOM</code>, in this case <code>0x11</code> (decimal 17)</li> <li><code>func1</code> is the name of the next RPC call</li> <li>The <code>&lt;no args&gt;</code> is the real help text this time.  This RPC call <code>func1</code> requires no arguments, like <code>komodo-cli getinfo</code></li> <li>The <code>0,0,'1', EVAL_CUSTOM</code> mean: 0 mandatory parameters, maximum of 0 parameters, 1 is the function id for custom consensus <code>EVAL_CUSTOM</code>, in this case <code>0x11</code> (decimal 17)</li></ul> <h3 id="declaration-of-functions"><a href="#declaration-of-functions" aria-hidden="true" class="header-anchor">#</a> Declaration of functions</h3> <div class="language-cpp extra-class"><pre class="language-cpp"><code><span class="token keyword">bool</span> <span class="token function">custom_validate</span><span class="token punctuation">(</span><span class="token keyword">struct</span> <span class="token class-name">CCcontract_info</span> <span class="token operator">*</span>cp<span class="token punctuation">,</span><span class="token keyword">int32_t</span> height<span class="token punctuation">,</span>Eval <span class="token operator">*</span>eval<span class="token punctuation">,</span><span class="token keyword">const</span> CTransaction tx<span class="token punctuation">)</span><span class="token punctuation">;</span>
UniValue <span class="token function">custom_func0</span><span class="token punctuation">(</span><span class="token keyword">uint64_t</span> txfee<span class="token punctuation">,</span><span class="token keyword">struct</span> <span class="token class-name">CCcontract_info</span> <span class="token operator">*</span>cp<span class="token punctuation">,</span>cJSON <span class="token operator">*</span>params<span class="token punctuation">)</span><span class="token punctuation">;</span>
UniValue <span class="token function">custom_func1</span><span class="token punctuation">(</span><span class="token keyword">uint64_t</span> txfee<span class="token punctuation">,</span><span class="token keyword">struct</span> <span class="token class-name">CCcontract_info</span> <span class="token operator">*</span>cp<span class="token punctuation">,</span>cJSON <span class="token operator">*</span>params<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>These functions follow the naming convention of <code>MYCCNAME</code> with a <code>_</code>.  Validation is always required and named <code>MYCCNAME</code> + <code>_validate</code>.  MYCCNAME is <code>custom</code>, therefore the validate function is called <code>custom_validate</code>.   If MYCCNAME was defined as <code>mylo</code>, then my validate function would be called <code>mylo_validate</code>.  Odds are you will name your first cclib after yourself or someone else just as loveable.</p> <p>The validation code is the most important code - it is what makes blockchains sources of truth.  Their truthiness relies on validation based on cryptographic principles.</p> <p>Functions <code>custom_func0</code> and <code>custom_func1</code> follow the internal automatic module wiring of cclib.  Again <code>MYCCNAME</code> + <code>_</code> + <code>RPCFUNCS</code> declared earlier.</p> <h3 id="automatic-wiring-custom-rpc-function-dispatcher"><a href="#automatic-wiring-custom-rpc-function-dispatcher" aria-hidden="true" class="header-anchor">#</a> Automatic wiring, custom RPC function dispatcher</h3> <p>The following code is part of the automatic wiring that allows a developer to use 3 files, the <code>.h</code> the <code>.cpp</code> and the <code>makecustom</code> makefile.   Automatic wiring saves a developer from potentially  introducing bugs in the consensus and by virtue of this saving, testers, users and organizations many hours of resources.</p> <p>The custom dispatch is used for dispatching the RPC function declared earlier.</p> <div class="language-cpp extra-class"><pre class="language-cpp"><code><span class="token macro property">#<span class="token directive keyword">define</span> CUSTOM_DISPATCH \
if ( cp-&gt;evalcode == EVAL_CUSTOM ) \
{ \
    if ( strcmp(method,&quot;func0&quot;) == 0 ) \
        return(custom_func0(txfee,cp,params)); \
    else if ( strcmp(method,&quot;func1&quot;) == 0 ) \
        return(custom_func1(txfee,cp,params)); \
    else \
    { \
        result.push_back(Pair(&quot;result&quot;,&quot;error&quot;)); \
        result.push_back(Pair(&quot;error&quot;,&quot;invalid customcc method&quot;)); \
        result.push_back(Pair(&quot;method&quot;,method)); \
        return(result); \
    } \
}</span>
</code></pre></div><p>The developer must then map the RPC names to the function/method.  This mapping follows the same naming convention that has already been defined.  Namely, <code>MYCCNAME</code> + <code>_</code> + <code>FUNCTIONNAME</code>.  If no match, then an error message returned and no harm done.</p> <p>e.g.</p> <div class="language-cpp extra-class"><pre class="language-cpp"><code>    <span class="token keyword">if</span> <span class="token punctuation">(</span> <span class="token function">strcmp</span><span class="token punctuation">(</span>method<span class="token punctuation">,</span><span class="token string">&quot;func0&quot;</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">0</span> <span class="token punctuation">)</span> \
        <span class="token keyword">return</span><span class="token punctuation">(</span><span class="token function">custom_func0</span><span class="token punctuation">(</span>txfee<span class="token punctuation">,</span>cp<span class="token punctuation">,</span>params<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> \
</code></pre></div><p>Finally, in the course of looking where to route the RPC request</p> <h2 id="customcc-cpp-file-implementation-of-functions"><a href="#customcc-cpp-file-implementation-of-functions" aria-hidden="true" class="header-anchor">#</a> customcc.cpp file - implementation of functions</h2> <p>Ref: <a href="https://github.com/jl777/komodo/blob/jl777/src/cc/eval.h#L63" target="_blank" rel="noopener noreferrer">^1a<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p> <p>Ref: <a href="https://github.com/jl777/komodo/blob/jl777/src/cc/cclib.cpp#L31" target="_blank" rel="noopener noreferrer">^1b<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p></div> <footer class="page-edit"><div class="edit-link"><a href="https://github.com/komodoplatform/Documentation/edit/master/docs/basic-docs/customconsensus/custom.md" target="_blank" rel="noopener noreferrer">Suggest an improvement for this page</a> <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></div> <!----></footer> <!----> </main></div><div class="global-ui"></div></div>
    <script src="/assets/js/app.38351d9b.js" defer></script><script src="/assets/js/2.c8a0d3c8.js" defer></script><script src="/assets/js/23.48a6b7ab.js" defer></script>
  </body>
</html>
